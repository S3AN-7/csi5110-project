   class index                          filepaths  ... card type data set
0            0  ./data/train/ace of clubs/001.jpg  ...       ace    train
1            0  ./data/train/ace of clubs/002.jpg  ...       ace    train
2            0  ./data/train/ace of clubs/003.jpg  ...       ace    train
3            0  ./data/train/ace of clubs/004.jpg  ...       ace    train
4            0  ./data/train/ace of clubs/005.jpg  ...       ace    train

[5 rows x 5 columns]
Label Mapping: {'ace of clubs': 0, 'ace of diamonds': 1, 'ace of hearts': 2, 'ace of spades': 3, 'eight of clubs': 4, 'eight of diamonds': 5, 'eight of hearts': 6, 'eight of spades': 7, 'five of clubs': 8, 'five of diamonds': 9, 'five of hearts': 10, 'five of spades': 11, 'four of clubs': 12, 'four of diamonds': 13, 'four of hearts': 14, 'four of spades': 15, 'jack of clubs': 16, 'jack of diamonds': 17, 'jack of hearts': 18, 'jack of spades': 19, 'joker': 20, 'king of clubs': 21, 'king of diamonds': 22, 'king of hearts': 23, 'king of spades': 24, 'nine of clubs': 25, 'nine of diamonds': 26, 'nine of hearts': 27, 'nine of spades': 28, 'queen of clubs': 29, 'queen of diamonds': 30, 'queen of hearts': 31, 'queen of spades': 32, 'seven of clubs': 33, 'seven of diamonds': 34, 'seven of hearts': 35, 'seven of spades': 36, 'six of clubs': 37, 'six of diamonds': 38, 'six of hearts': 39, 'six of spades': 40, 'ten of clubs': 41, 'ten of diamonds': 42, 'ten of hearts': 43, 'ten of spades': 44, 'three of clubs': 45, 'three of diamonds': 46, 'three of hearts': 47, 'three of spades': 48, 'two of clubs': 49, 'two of diamonds': 50, 'two of hearts': 51, 'two of spades': 52}
   class index                          filepaths  ... data set encoded_labels
0            0  ./data/train/ace of clubs/001.jpg  ...    train              0
1            0  ./data/train/ace of clubs/002.jpg  ...    train              0
2            0  ./data/train/ace of clubs/003.jpg  ...    train              0
3            0  ./data/train/ace of clubs/004.jpg  ...    train              0
4            0  ./data/train/ace of clubs/005.jpg  ...    train              0

[5 rows x 6 columns]
4893 1631 1631
Found 4892 validated image filenames belonging to 53 classes.
Found 1631 validated image filenames belonging to 53 classes.
Found 1631 validated image filenames belonging to 53 classes.

 1/51 [..............................] - ETA: 6s - loss: 0.7239 - accuracy: 0.7812
 4/51 [=>............................] - ETA: 0s - loss: 1.1384 - accuracy: 0.7031
 7/51 [===>..........................] - ETA: 0s - loss: 1.1325 - accuracy: 0.7321
10/51 [====>.........................] - ETA: 0s - loss: 1.1177 - accuracy: 0.7281
13/51 [======>.......................] - ETA: 0s - loss: 1.1076 - accuracy: 0.7284
16/51 [========>.....................] - ETA: 0s - loss: 1.1674 - accuracy: 0.7266
19/51 [==========>...................] - ETA: 0s - loss: 1.1325 - accuracy: 0.7253
22/51 [===========>..................] - ETA: 0s - loss: 1.1627 - accuracy: 0.7358
25/51 [=============>................] - ETA: 0s - loss: 1.1582 - accuracy: 0.7337
28/51 [===============>..............] - ETA: 0s - loss: 1.1450 - accuracy: 0.7355
31/51 [=================>............] - ETA: 0s - loss: 1.1474 - accuracy: 0.7349
34/51 [===================>..........] - ETA: 0s - loss: 1.1152 - accuracy: 0.7426
37/51 [====================>.........] - ETA: 0s - loss: 1.1023 - accuracy: 0.7424
40/51 [======================>.......] - ETA: 0s - loss: 1.1006 - accuracy: 0.7437
43/51 [========================>.....] - ETA: 0s - loss: 1.1173 - accuracy: 0.7420
46/51 [==========================>...] - ETA: 0s - loss: 1.0893 - accuracy: 0.7452
49/51 [===========================>..] - ETA: 0s - loss: 1.0686 - accuracy: 0.7455
51/51 [==============================] - 1s 22ms/step - loss: 1.0607 - accuracy: 0.7456
Validation Loss: 1.060691237449646, Validation Accuracy: 0.7455548644065857
[VAI INFO] Start CrossLayerEqualization...

 1/10 [==>...........................] - ETA: 0s
 3/10 [========>.....................] - ETA: 0s
 5/10 [==============>...............] - ETA: 0s
 7/10 [====================>.........] - ETA: 0s
 9/10 [==========================>...] - ETA: 0s
10/10 [==============================] - 0s 39ms/step
[VAI INFO] CrossLayerEqualization Done.
[VAI INFO] Start Quantize Calibration...

  1/153 [..............................] - ETA: 2:51
  2/153 [..............................] - ETA: 44s 
  3/153 [..............................] - ETA: 44s
  4/153 [..............................] - ETA: 43s
  5/153 [..............................] - ETA: 43s
  6/153 [>.............................] - ETA: 43s
  7/153 [>.............................] - ETA: 43s
  8/153 [>.............................] - ETA: 42s
  9/153 [>.............................] - ETA: 42s
 10/153 [>.............................] - ETA: 42s
 11/153 [=>............................] - ETA: 42s
 12/153 [=>............................] - ETA: 41s
 13/153 [=>............................] - ETA: 41s
 14/153 [=>............................] - ETA: 41s
 15/153 [=>............................] - ETA: 40s
 16/153 [==>...........................] - ETA: 40s
 17/153 [==>...........................] - ETA: 40s
 18/153 [==>...........................] - ETA: 40s
 19/153 [==>...........................] - ETA: 39s
 20/153 [==>...........................] - ETA: 39s
 21/153 [===>..........................] - ETA: 39s
 22/153 [===>..........................] - ETA: 38s
 23/153 [===>..........................] - ETA: 38s
 24/153 [===>..........................] - ETA: 38s
 25/153 [===>..........................] - ETA: 38s
 26/153 [====>.........................] - ETA: 37s
 27/153 [====>.........................] - ETA: 37s
 28/153 [====>.........................] - ETA: 37s
 29/153 [====>.........................] - ETA: 36s
 30/153 [====>.........................] - ETA: 36s
 31/153 [=====>........................] - ETA: 36s
 32/153 [=====>........................] - ETA: 36s
 33/153 [=====>........................] - ETA: 35s
 34/153 [=====>........................] - ETA: 35s
 35/153 [=====>........................] - ETA: 35s
 36/153 [======>.......................] - ETA: 34s
 37/153 [======>.......................] - ETA: 34s
 38/153 [======>.......................] - ETA: 34s
 39/153 [======>.......................] - ETA: 33s
 40/153 [======>.......................] - ETA: 33s
 41/153 [=======>......................] - ETA: 33s
 42/153 [=======>......................] - ETA: 33s
 43/153 [=======>......................] - ETA: 32s
 44/153 [=======>......................] - ETA: 32s
 45/153 [=======>......................] - ETA: 32s
 46/153 [========>.....................] - ETA: 31s
 47/153 [========>.....................] - ETA: 31s
 48/153 [========>.....................] - ETA: 31s
 49/153 [========>.....................] - ETA: 30s
 50/153 [========>.....................] - ETA: 30s
 51/153 [=========>....................] - ETA: 30s
 52/153 [=========>....................] - ETA: 30s
 53/153 [=========>....................] - ETA: 29s
 54/153 [=========>....................] - ETA: 29s
 55/153 [=========>....................] - ETA: 29s
 56/153 [=========>....................] - ETA: 28s
 57/153 [==========>...................] - ETA: 28s
 58/153 [==========>...................] - ETA: 28s
 59/153 [==========>...................] - ETA: 27s
 60/153 [==========>...................] - ETA: 27s
 61/153 [==========>...................] - ETA: 27s
 62/153 [===========>..................] - ETA: 27s
 63/153 [===========>..................] - ETA: 26s
 64/153 [===========>..................] - ETA: 26s
 65/153 [===========>..................] - ETA: 26s
 66/153 [===========>..................] - ETA: 25s
 67/153 [============>.................] - ETA: 25s
 68/153 [============>.................] - ETA: 25s
 69/153 [============>.................] - ETA: 24s
 70/153 [============>.................] - ETA: 24s
 71/153 [============>.................] - ETA: 24s
 72/153 [=============>................] - ETA: 24s
 73/153 [=============>................] - ETA: 23s
 74/153 [=============>................] - ETA: 23s
 75/153 [=============>................] - ETA: 23s
 76/153 [=============>................] - ETA: 22s
 77/153 [==============>...............] - ETA: 22s
 78/153 [==============>...............] - ETA: 22s
 79/153 [==============>...............] - ETA: 21s
 80/153 [==============>...............] - ETA: 21s
 81/153 [==============>...............] - ETA: 21s
 82/153 [===============>..............] - ETA: 21s
 83/153 [===============>..............] - ETA: 20s
 84/153 [===============>..............] - ETA: 20s
 85/153 [===============>..............] - ETA: 20s
 86/153 [===============>..............] - ETA: 19s
 87/153 [================>.............] - ETA: 19s
 88/153 [================>.............] - ETA: 19s
 89/153 [================>.............] - ETA: 18s
 90/153 [================>.............] - ETA: 18s
 91/153 [================>.............] - ETA: 18s
 92/153 [=================>............] - ETA: 18s
 93/153 [=================>............] - ETA: 17s
 94/153 [=================>............] - ETA: 17s
 95/153 [=================>............] - ETA: 17s
 96/153 [=================>............] - ETA: 16s
 97/153 [==================>...........] - ETA: 16s
 98/153 [==================>...........] - ETA: 16s
 99/153 [==================>...........] - ETA: 16s
100/153 [==================>...........] - ETA: 15s
101/153 [==================>...........] - ETA: 15s
102/153 [===================>..........] - ETA: 15s
103/153 [===================>..........] - ETA: 14s
104/153 [===================>..........] - ETA: 14s
105/153 [===================>..........] - ETA: 14s
106/153 [===================>..........] - ETA: 13s
107/153 [===================>..........] - ETA: 13s
108/153 [====================>.........] - ETA: 13s
109/153 [====================>.........] - ETA: 13s
110/153 [====================>.........] - ETA: 12s
111/153 [====================>.........] - ETA: 12s
112/153 [====================>.........] - ETA: 12s
113/153 [=====================>........] - ETA: 11s
114/153 [=====================>........] - ETA: 11s
115/153 [=====================>........] - ETA: 11s
116/153 [=====================>........] - ETA: 10s
117/153 [=====================>........] - ETA: 10s
118/153 [======================>.......] - ETA: 10s
119/153 [======================>.......] - ETA: 10s
120/153 [======================>.......] - ETA: 9s 
121/153 [======================>.......] - ETA: 9s
122/153 [======================>.......] - ETA: 9s
123/153 [=======================>......] - ETA: 8s
124/153 [=======================>......] - ETA: 8s
125/153 [=======================>......] - ETA: 8s
126/153 [=======================>......] - ETA: 8s
127/153 [=======================>......] - ETA: 7s
128/153 [========================>.....] - ETA: 7s
129/153 [========================>.....] - ETA: 7s
130/153 [========================>.....] - ETA: 6s
131/153 [========================>.....] - ETA: 6s
132/153 [========================>.....] - ETA: 6s
133/153 [=========================>....] - ETA: 5s
134/153 [=========================>....] - ETA: 5s
135/153 [=========================>....] - ETA: 5s
136/153 [=========================>....] - ETA: 5s
137/153 [=========================>....] - ETA: 4s
138/153 [==========================>...] - ETA: 4s
139/153 [==========================>...] - ETA: 4s
140/153 [==========================>...] - ETA: 3s
141/153 [==========================>...] - ETA: 3s
142/153 [==========================>...] - ETA: 3s
143/153 [===========================>..] - ETA: 2s
144/153 [===========================>..] - ETA: 2s
145/153 [===========================>..] - ETA: 2s
146/153 [===========================>..] - ETA: 2s
147/153 [===========================>..] - ETA: 1s
148/153 [============================>.] - ETA: 1s
149/153 [============================>.] - ETA: 1s
150/153 [============================>.] - ETA: 0s
151/153 [============================>.] - ETA: 0s
152/153 [============================>.] - ETA: 0s
153/153 [==============================] - ETA: 0s
153/153 [==============================] - 46s 298ms/step
[VAI INFO] Quantize Calibration Done.
[VAI INFO] Start Post-Quant Model Refinement...
[VAI INFO] Start Quantize Position Ajustment...
[VAI INFO] Quantize Position Ajustment Done.
[VAI INFO] Post-Quant Model Refninement Done.
[VAI INFO] Start Model Finalization...
[VAI INFO] Model Finalization Done.
[VAI INFO] Quantization Finished.

 1/51 [..............................] - ETA: 16s - loss: 1.6939 - accuracy: 0.5938
 3/51 [>.............................] - ETA: 1s - loss: 1.1292 - accuracy: 0.7083 
 5/51 [=>............................] - ETA: 1s - loss: 1.3952 - accuracy: 0.6812
 7/51 [===>..........................] - ETA: 1s - loss: 1.4218 - accuracy: 0.6786
 9/51 [====>.........................] - ETA: 1s - loss: 1.2674 - accuracy: 0.6944
11/51 [=====>........................] - ETA: 1s - loss: 1.2045 - accuracy: 0.7017
13/51 [======>.......................] - ETA: 1s - loss: 1.1289 - accuracy: 0.7163
15/51 [=======>......................] - ETA: 1s - loss: 1.0905 - accuracy: 0.7208
17/51 [=========>....................] - ETA: 1s - loss: 1.0873 - accuracy: 0.7188
19/51 [==========>...................] - ETA: 1s - loss: 1.0852 - accuracy: 0.7220
21/51 [===========>..................] - ETA: 1s - loss: 1.0864 - accuracy: 0.7232
23/51 [============>.................] - ETA: 1s - loss: 1.0428 - accuracy: 0.7323
25/51 [=============>................] - ETA: 1s - loss: 1.0546 - accuracy: 0.7300
27/51 [==============>...............] - ETA: 0s - loss: 1.0515 - accuracy: 0.7292
29/51 [================>.............] - ETA: 0s - loss: 1.0505 - accuracy: 0.7295
31/51 [=================>............] - ETA: 0s - loss: 1.0652 - accuracy: 0.7248
33/51 [==================>...........] - ETA: 0s - loss: 1.0383 - accuracy: 0.7301
35/51 [===================>..........] - ETA: 0s - loss: 1.0313 - accuracy: 0.7321
37/51 [====================>.........] - ETA: 0s - loss: 1.0372 - accuracy: 0.7314
39/51 [=====================>........] - ETA: 0s - loss: 1.0624 - accuracy: 0.7332
41/51 [=======================>......] - ETA: 0s - loss: 1.0741 - accuracy: 0.7309
43/51 [========================>.....] - ETA: 0s - loss: 1.0797 - accuracy: 0.7318
45/51 [=========================>....] - ETA: 0s - loss: 1.0731 - accuracy: 0.7306
47/51 [==========================>...] - ETA: 0s - loss: 1.0640 - accuracy: 0.7314
49/51 [===========================>..] - ETA: 0s - loss: 1.0488 - accuracy: 0.7353
51/51 [==============================] - ETA: 0s - loss: 1.0588 - accuracy: 0.7376
51/51 [==============================] - 2s 39ms/step - loss: 1.0588 - accuracy: 0.7376
Validation Loss: 1.0587724447250366, Validation Accuracy: 0.7375842928886414
(vitis-ai-tensorflow2) Vitis-AI /workspace/test > bash ./compile.sh 
**************************************************
* VITIS_AI Compilation - Xilinx Inc.
**************************************************
[INFO] Namespace(batchsize=1, inputs_shape=None, layout='NHWC', model_files=['./models/adam_100_da_best_quantized.h5'], model_type='tensorflow2', named_inputs_shape=None, out_filename='/tmp/adam_100_da_best_quantized_DPUCZDX8G_ISA1_B4096_org.xmodel', proto=None)
[INFO] tensorflow2 model: /workspace/test/models/adam_100_da_best_quantized.h5
[INFO] keras version: 2.8.0
[INFO] Tensorflow Keras model type: sequential
[INFO] parse raw model     :100%|████████████████████████████████████████████████████████████| 16/16 [00:00<00:00, 41374.15it/s]               
[INFO] infer shape (NHWC)  :100%|████████████████████████████████████████████████████████████| 28/28 [00:00<00:00, 2716.71it/s]                
[INFO] perform level-0 opt :100%|████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 1157.37it/s]                  
[INFO] perform level-1 opt :100%|████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 4304.06it/s]                  
[INFO] generate xmodel     :100%|████████████████████████████████████████████████████████████| 28/28 [00:00<00:00, 211.38it/s]                 
[INFO] dump xmodel: /tmp/adam_100_da_best_quantized_DPUCZDX8G_ISA1_B4096_org.xmodel
[UNILOG][INFO] Compile mode: dpu
[UNILOG][INFO] Debug mode: function
[UNILOG][INFO] Target architecture: DPUCZDX8G_ISA1_B4096
[UNILOG][INFO] Graph name: sequential, with op num: 44
[UNILOG][INFO] Begin to compile...
[UNILOG][INFO] Total device subgraph number 3, DPU subgraph number 1
[UNILOG][INFO] Compile done.
[UNILOG][INFO] The meta json is saved to "/workspace/test/./outputs_kv260/meta.json"
[UNILOG][INFO] The compiled xmodel is saved to "/workspace/test/./outputs_kv260/adam_100_da_best_quantized.xmodel"
[UNILOG][INFO] The compiled xmodel's md5sum is 76bd603c229c333331b1558300826c2c, and has been saved to "/workspace/test/./outputs_kv260/md5sum.txt"